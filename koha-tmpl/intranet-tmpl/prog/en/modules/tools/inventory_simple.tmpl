<!-- TMPL_INCLUDE NAME="doc-head-open.inc" -->
<title>Koha &rsaquo; Tools &rsaquo; Inventory</title>
<!-- TMPL_INCLUDE NAME="doc-head-close.inc" -->
<!-- TMPL_INCLUDE NAME="calendar.inc" -->
<script type="text/javascript" src="<!-- TMPL_VAR NAME="themelang" -->/lib/jquery/plugins/jquery.tablesorter.min.js"></script>
</head>
<body>
<!-- B12 -->
<!-- TMPL_INCLUDE NAME="header.inc" -->
<!-- TMPL_INCLUDE NAME="cat-search.inc" -->

<script type="text/javascript">
        //<![CDATA[
        $(document).ready(function() {
            $("#itemst").tablesorter({<!-- TMPL_IF EXPR="dateformat eq 'metric'" -->
                 dateFormat: 'uk',<!-- /TMPL_IF -->
                 widgets : ['zebra']
            });
        });
        //]]>
</script>
       
<style type="text/css">
	/*Print*/
	@media print {
		body {
			padding: 0;
		}
		h1 {
			text-align: center;
		}
		a {
			color: black;
			text-decoration: none;
		}
		input[type="submit"] {
			display: none;
		}
		
		input[type="button"] {
			display: none;
		}
		#filterproblems {
	    	display: none;
		}
	}
</style>

<div id="breadcrumbs"><a href="/cgi-bin/koha/mainpage.pl">Home</a> &rsaquo; <a href="/cgi-bin/koha/tools/tools-home.pl">Tools</a> &rsaquo; <!-- TMPL_IF NAME="result" --><a href="/cgi-bin/koha/tools/inventory_simple.pl">Inventory</a> &rsaquo; Results<!-- TMPL_ELSE -->Inventory<!-- /TMPL_IF --></div>
<div id="doc3" class="yui-t2">
  <div id="bd">
  <div id="yui-main">
    <div class="yui-b">
    <h1>Inventory/Stocktaking</h1>
    <!-- TMPL_IF NAME="Number" --><div class="dialog message"><!-- TMPL_VAR NAME="Number" --> items modified : datelastseen, datelast_stocktaking set to <!-- TMPL_VAR NAME="date" --></div><!-- /TMPL_IF -->
    <!-- TMPL_IF NAME="errorfile" --><div class="dialog alert"><!-- TMPL_VAR NAME="errorfile" --> can't be opened</div><!-- /TMPL_IF -->
    <!-- TMPL_IF NAME="errorsaisie" --><div class="dialog alert">Please select a barcode file</div><!-- /TMPL_IF -->
    <!-- TMPL_IF NAME="errorcomparison" --><div class="dialog alert">Please select all comparison fields</div><!-- /TMPL_IF -->
	<!-- TMPL_UNLESS NAME="result" -->
	<div class="yui-g">
    <form method="post" action="/cgi-bin/koha/tools/inventory_simple.pl" enctype="multipart/form-data">
        <fieldset class="rows">
          <legend>Selection</legend>
    	  <ol>
            <li><label for="uploadbarcodes" style="color: red;">Barcode file: </label> <input type="file" id="uploadbarcodes" name="uploadbarcodes" /></li>
          </ol>
        </fieldset>
        <fieldset class="rows">
            <legend>Update date</legend>
            <ol>
            <li><label for="setdate">Set inventory date to:</label> <input type="text" id="setdate" name="setdate" value="<!-- TMPL_VAR NAME="today" -->" />
                <img src="<!-- TMPL_VAR NAME="themelang" -->/lib/calendar/cal.gif" id="setdate_button" alt="Show Calendar" />
            <script type="text/javascript">
            Calendar.setup(
            {
            inputField : "setdate",
            ifFormat : "<!-- TMPL_VAR NAME="DHTMLcalendar_dateformat" -->",
            button : "setdate_button"
            }
            );
            </script>
            <div class="hint"><!-- TMPL_INCLUDE NAME="date-format.inc" --></div>
            </li>
          </ol>
        </fieldset>
        <fieldset class="rows">
        <legend>Comparison</legend>
        <ol><li>
        <label for="branchloop" style="color: red;">Library</label>
        <select id="branchloop" name="branchcodecomparison" style="width:12em;">
            <!-- TMPL_LOOP NAME="branchloop" -->
                <!-- TMPL_IF NAME="selected" -->
                <option value="<!-- TMPL_VAR NAME="value" -->" selected="selected"><!-- TMPL_VAR NAME="branchname" --></option>
                <!-- TMPL_ELSE -->
                <option value="<!-- TMPL_VAR NAME="value" -->"><!-- TMPL_VAR NAME="branchname" --></option>
                <!-- /TMPL_IF -->
            <!-- /TMPL_LOOP -->
        </select>
        </li>
        <li>
        <label for="locationloop" style="color: red;">Item Location (items.location) is</label> 
        <select id="locationloop" name="locationcomparison">
            <!-- TMPL_LOOP NAME="authorised_values" -->
                <!-- TMPL_IF NAME="selected" -->
                <option value="<!-- TMPL_VAR NAME="authorised_value" -->" selected="selected"><!-- TMPL_VAR NAME="lib" --></option>
                <!-- TMPL_ELSE -->
                <option value="<!-- TMPL_VAR NAME="authorised_value" -->"><!-- TMPL_VAR NAME="lib" --></option>
                <!-- /TMPL_IF -->
            <!-- /TMPL_LOOP -->
        </select>
        </li>
        <li>
			<label for="callnumber_type" style="color: red;">Items are located in : </label>
			<select name="callnumber_type" id="callnumber_type" size="1">
				<option value="store_callnumber" >Store</option>
				<option value="freeaccess_callnumber" >Free Access</option>
			</select>
        </li>
        <li>
            <label for="callnumber_prefix" style="color: red;">Item callnumber prefix: </label>
            <input type="text" name="callnumber_prefix" id="callnumber_prefix" value="<!-- TMPL_VAR NAME="callnumber_prefix" -->" />
        </li>
        <li>
        	<label for="callnumber_min">begin: </label>
            <input type="text" name="callnumber_min" id="callnumber_min" value="<!-- TMPL_VAR NAME="callnumber_min" -->" />
        </li>
        <li>
        	<label for="callnumber_max">end: </label>
            <input type="text" name="callnumber_max" id="callnumber_max" value="<!-- TMPL_VAR NAME="callnumber_max" -->" />
        </li>
	   </ol>
	   </fieldset>
	   <fieldset class="rows">
       <ol>
            <li><label for="pagesize">Show: </label>
                <input type="text" id="pagesize" name="pagesize" value="<!-- TMPL_VAR NAME="pagesize" -->" maxlength="5" size="5" /> items
            </li>
        </ol>
        </fieldset>
        <fieldset class="rows">
        <ol>
	        <li>
                <label for="CSVexport">Export to csv file</label>
                <input type="checkbox" name="CSVexport" id="CSVexport" />
            </li>
            <li><label for="new_csv_separator">CSV separator: </label>
                <select name="csv_separator" id="csv_separator">
                <option value=":">Colon (:)</option>
                <option value="," selected="selected">Comma (,)</option>
                <option value="|">Pipe (|)</option>
                <option value=";">Semi-colon (;)</option>
                <option value="#">Sharp (#)</option>
                <option value="\t">Tabulation (\t)</option>
                </select>
            </li>
            <li><label for="new_end_line">End line: </label>
                <select name="end_line" id="end_line">
                <option value=":">Colon (:)</option>
                <option value=",">Comma (,)</option>
                <option value="|">Pipe (|)</option>
                <option value=";">Semi-colon (;)</option>
	            <option value="#">Sharp (#)</option>
	            <option value="\t">Tabulation (\t)</option>
	            <option value="\n" selected="selected">New line (\n)</option>
	            </select>
	        </li>
	        <li><label for="new_data_protection">Data protection: </label>
	            <select name="data_protection" id="data_protection">
	            <option value=":">Colon (:)</option>
	            <option value=",">Comma (,)</option>
	            <option value="|">Pipe (|)</option>
	            <option value=";">Semi-colon (;)</option>
	            <option value="#">Sharp (#)</option>
	            <option value="'" selected="selected">Quote(')</option>
	            <option value='"'>Double Quote(")</option>
	            </select>
	        </li>
        </ol>
        </fieldset>
       <input type="hidden" name="op" value="do_it" />
       <fieldset class="action"><input type="submit" value="Submit" class="button" /></fieldset>
    </form>
	</div>
	</div>
	<!-- /TMPL_UNLESS -->
    <!-- TMPL_IF NAME="result" -->
    	<input type="button" value="Print" id="print" onclick="window.print();return false;" />
        <form method="post" id="filterproblems" action="/cgi-bin/koha/tools/inventory_simple.pl" class="checkboxed">
        <!-- TMPL_LOOP NAME="barcodeloop" -->
            <input type="hidden" name="barcodeitem" value="<!-- TMPL_VAR NAME="barcodeitem" -->" />
        <!-- /TMPL_LOOP -->
        <input type="hidden" name="minlocation" value="<!-- TMPL_VAR NAME="minlocation" -->" />
        <input type="hidden" name="maxlocation" value="<!-- TMPL_VAR NAME="maxlocation" -->" />
        <input type="hidden" name="locationcomparison" value="<!-- TMPL_VAR NAME="locationcomparison" -->" />
        <input type="hidden" name="branchcodecomparison" value="<!-- TMPL_VAR NAME="branchcodecomparison" -->" />
        <input type="hidden" name="pagesize" value="<!-- TMPL_VAR NAME="pagesize" -->" />
        <input type="hidden" name="offset" value="<!-- TMPL_VAR NAME="offset" -->" />
        <input type="hidden" name="filter" value="do_it" />
        <input type="hidden" name="filteronly" value="do_it" />
        <div style="padding : .3em 0">
           <input type="checkbox" name="noproblem"            <!-- TMPL_IF EXPR="noproblem            || !filter" -->checked="checked"<!-- /TMPL_IF --> />&nbsp;No problems
           <input type="checkbox" name="manquant"             <!-- TMPL_IF EXPR="manquant             || !filter" -->checked="checked"<!-- /TMPL_IF --> />&nbsp;Item withdrawn
           <input type="checkbox" name="nonrecole"            <!-- TMPL_IF EXPR="nonrecole            || !filter" -->checked="checked"<!-- /TMPL_IF --> />&nbsp;No stocktaking
           <input type="checkbox" name="mauvaiselocalisation" <!-- TMPL_IF EXPR="mauvaiselocalisation || !filter" -->checked="checked"<!-- /TMPL_IF --> />&nbsp;Bad localisation
           <input type="checkbox" name="enpret"               <!-- TMPL_IF EXPR="enpret               || !filter" -->checked="checked"<!-- /TMPL_IF --> />&nbsp;On loan / on stack
           <input type="checkbox" name="CBinexistant"         <!-- TMPL_IF EXPR="CBinexistant         || !filter" -->checked="checked"<!-- /TMPL_IF --> />&nbsp;Barcode not found
           <input type="submit" value="Apply filter" class="submit" />
        </div>
        </form>
       <table id="itemst">
        <thead>
         <tr>
            <th>Barcode</th>
            <th>Callnumber</th>
            <th>Title</th>
            <th>Publication year</th>
            <th>Unseen since</th>
            <th>Library</th>
            <th>Location</th>
            <th>Problems</th>
         </tr>
        </thead>
        <tbody>
         <!-- TMPL_LOOP NAME="loop" -->
           <tr>
            <td>
                <a href="/cgi-bin/koha/catalogue/moredetail.pl?biblionumber=<!-- TMPL_VAR NAME='biblionumber' -->&amp;itemnumber=<!-- TMPL_VAR NAME='itemnumber' -->#item<!-- TMPL_VAR NAME='itemnumber' -->">
                    <!-- TMPL_VAR NAME="barcode" -->
                </a>
            </td>
            <td><b><!-- TMPL_VAR NAME="itemcallnumber" --></b></td>
            <td><p><a href="#" onclick="window.open('/cgi-bin/koha/catalogue/MARCdetail.pl?biblionumber=<!-- TMPL_VAR NAME="biblionumber" -->','marcview','width=800,height=600,toolbar=0,scrollbars=1');"><!-- TMPL_VAR NAME="title" escape="html" --></a></p>
                <p><!-- TMPL_VAR NAME="author" --></p>
            </td>
            <td><!-- TMPL_VAR NAME="publicationyear" --></td>
            <td><!-- TMPL_VAR NAME="datelastseen" --></td>
            <td><!-- TMPL_VAR NAME="holdingbranch" --></td>
            <td><!-- TMPL_VAR NAME="location" --></td>
            <td>
                 <!-- TMPL_IF NAME="ERR_WTHDRAWN" -->
                     <p style="background: red;">Item withdrawn</p>
                 <!-- TMPL_ELSIF NAME="ERR_ONLOAN" -->
                     <p style="background: red;">On loan</p>
                 <!-- TMPL_ELSIF NAME="ERR_COMM" -->
                     <p style="background: red;">On stack</p>                     
                 <!-- TMPL_ELSIF NAME="ERR_BARCODE" -->
                     <p style="background: red;">Barcode not found</p>
                 <!-- TMPL_ELSIF NAME="ERR_BRANCH" -->
                     <p style="background: red;">Bad library</p>                     
                 <!-- TMPL_ELSIF NAME="ERR_LOCATION" -->
                     <p style="background: red;">Bad location</p>
                 <!-- TMPL_ELSIF NAME="ERR_CALLNUMBER" -->
                     <p style="background: red;">Bad item callnumber</p>
                 <!-- TMPL_ELSIF NAME="ERR_STOCKTAKING" -->
                     <p style="background: red;">No stocktaking</p>
                 <!-- TMPL_ELSE -->
                     <p style="background: green;">None</p>
                 <!-- /TMPL_IF -->
            </td>
          </tr>
        <!-- /TMPL_LOOP -->
       </tbody>
      </table>
      <!-- TMPL_IF NAME="offset" -->
        <form method="post">
            <!-- TMPL_LOOP NAME="barcodeloop" -->
                <input type="hidden" name="barcodeitem" value="<!-- TMPL_VAR NAME="barcodeitem" -->" />
            <!-- /TMPL_LOOP -->
            <input type="hidden" name="minlocation" value="<!-- TMPL_VAR NAME="minlocation" -->" />
            <input type="hidden" name="maxlocation" value="<!-- TMPL_VAR NAME="maxlocation" -->" />
            <input type="hidden" name="locationcomparison" value="<!-- TMPL_VAR NAME="locationcomparison" -->" />
            <input type="hidden" name="branchcodecomparison" value="<!-- TMPL_VAR NAME="branchcodecomparison" -->" />
            <input type="hidden" name="pagesize" value="<!-- TMPL_VAR NAME="pagesize" -->" />
            <input type="hidden" name="offset" value="<!-- TMPL_VAR NAME="prevoffset" -->" />
            <input type="hidden" name="filter" value="do_it" />
            <!-- TMPL_IF NAME="noproblem" -->
                <input type="hidden" name="noproblem" value="on"/>
            <!-- TMPL_ELSE -->
                   <!-- TMPL_UNLESS NAME="filter" --><input type="hidden" name="noproblem" value="on"/><!-- /TMPL_UNLESS -->
            <!-- /TMPL_IF -->
            <!-- TMPL_IF NAME="manquant" -->
                <input type="hidden" name="manquant" value="on"/>
            <!-- TMPL_ELSE -->
                   <!-- TMPL_UNLESS NAME="filter" --><input type="hidden" name="manquant" value="on"/><!-- /TMPL_UNLESS -->
            <!-- /TMPL_IF -->
            <!-- TMPL_IF NAME="nonrecole" -->
                <input type="hidden" name="nonrecole" value="on"/>
            <!-- TMPL_ELSE -->
                   <!-- TMPL_UNLESS NAME="filter" --><input type="hidden" name="nonrecole" value="on"/><!-- /TMPL_UNLESS -->
            <!-- /TMPL_IF -->
            <!-- TMPL_IF NAME="mauvaiselocalisation" -->
                <input type="hidden" name="mauvaiselocalisation" value="on"/>
            <!-- TMPL_ELSE -->
                   <!-- TMPL_UNLESS NAME="filter" --><input type="hidden" name="mauvaiselocalisation" value="on"/><!-- /TMPL_UNLESS -->
            <!-- /TMPL_IF -->
            <!-- TMPL_IF NAME="enpret" -->
                <input type="hidden" name="enpret" value="on"/>
            <!-- TMPL_ELSE -->
                   <!-- TMPL_UNLESS NAME="filter" --><input type="hidden" name="enpret" value="on"/><!-- /TMPL_UNLESS -->
            <!-- /TMPL_IF -->
            <!-- TMPL_IF NAME="CBinexistant" -->
                <input type="hidden" name="CBinexistant" value="on"/>
            <!-- TMPL_ELSE -->
                   <!-- TMPL_UNLESS NAME="filter" --><input type="hidden" name="CBinexistant" value="on"/><!-- /TMPL_UNLESS -->
            <!-- /TMPL_IF -->
            
            <input type="submit" value="&lt;&lt; Continue" class="submit" />
        </form>
      <!-- /TMPL_IF -->
      <!-- TMPL_IF NAME="nextoffset" -->
        <form method="post">
            <!-- TMPL_LOOP NAME="barcodeloop" -->
                <input type="hidden" name="barcodeitem" value="<!-- TMPL_VAR NAME="barcodeitem" -->" />
            <!-- /TMPL_LOOP -->
            <input type="hidden" name="locationcomparison" value="<!-- TMPL_VAR NAME="locationcomparison" -->" />
            <input type="hidden" name="branchcodecomparison" value="<!-- TMPL_VAR NAME="branchcodecomparison" -->" />
            <input type="hidden" name="minlocation" value="<!-- TMPL_VAR NAME="minlocation" -->" />
            <input type="hidden" name="maxlocation" value="<!-- TMPL_VAR NAME="maxlocation" -->" />
            <input type="hidden" name="pagesize" value="<!-- TMPL_VAR NAME="pagesize" -->" />
            <input type="hidden" name="offset" value="<!-- TMPL_VAR NAME="nextoffset" -->" />
            <input type="hidden" name="filter" value="do_it" />
            <!-- TMPL_IF NAME="noproblem" -->
                <input type="hidden" name="noproblem" value="on"/>
            <!-- TMPL_ELSE -->
                   <!-- TMPL_UNLESS NAME="filter" --><input type="hidden" name="noproblem" value="on"/><!-- /TMPL_UNLESS -->
            <!-- /TMPL_IF -->
            <!-- TMPL_IF NAME="manquant" -->
                <input type="hidden" name="manquant" value="on"/>
            <!-- TMPL_ELSE -->
                   <!-- TMPL_UNLESS NAME="filter" --><input type="hidden" name="manquant" value="on"/><!-- /TMPL_UNLESS -->
            <!-- /TMPL_IF -->
            <!-- TMPL_IF NAME="nonrecole" -->
                <input type="hidden" name="nonrecole" value="on"/>
            <!-- TMPL_ELSE -->
                   <!-- TMPL_UNLESS NAME="filter" --><input type="hidden" name="nonrecole" value="on"/><!-- /TMPL_UNLESS -->
            <!-- /TMPL_IF -->
            <!-- TMPL_IF NAME="mauvaiselocalisation" -->
                <input type="hidden" name="mauvaiselocalisation" value="on"/>
            <!-- TMPL_ELSE -->
                   <!-- TMPL_UNLESS NAME="filter" --><input type="hidden" name="mauvaiselocalisation" value="on"/><!-- /TMPL_UNLESS -->
            <!-- /TMPL_IF -->
            <!-- TMPL_IF NAME="enpret" -->
                <input type="hidden" name="enpret" value="on"/>
            <!-- TMPL_ELSE -->
                   <!-- TMPL_UNLESS NAME="filter" --><input type="hidden" name="enpret" value="on"/><!-- /TMPL_UNLESS -->
            <!-- /TMPL_IF -->
            <!-- TMPL_IF NAME="CBinexistant" -->
                <input type="hidden" name="CBinexistant" value="on"/>
            <!-- TMPL_ELSE -->
                   <!-- TMPL_UNLESS NAME="filter" --><input type="hidden" name="CBinexistant" value="on"/><!-- /TMPL_UNLESS -->
            <!-- /TMPL_IF -->
           
            <input type="submit" value="Continue &gt;&gt;" class="submit" />
        </form>
      <!-- /TMPL_IF -->
    </div>
    <!-- /TMPL_IF -->
</div>
<div class="yui-b">
<!-- TMPL_INCLUDE NAME="tools-menu.inc" -->
</div>
</div>
<!-- TMPL_INCLUDE NAME="intranet-bottom.inc" -->
